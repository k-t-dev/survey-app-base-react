{"ast":null,"code":"var _jsxFileName = \"/Users/user/Desktop/DEVELOPMENT/survey/frontend/src/pages/SurevyCommentPage.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport { useParams, useNavigate, useLocation } from \"react-router-dom\";\nimport { FaStar } from \"react-icons/fa\";\nimport './SurevyCommentPage.css';\nimport MenuBar from \"./MenuBar\"; // Import the MenuBar component\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SurevyCommentPage = () => {\n  _s();\n  const {\n    shopId\n  } = useParams();\n  const {\n    companyId\n  } = useParams();\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  // `state` から取得 or `sessionStorage` から取得\n  const [surveyData, setSurveyData] = useState(() => {\n    var _location$state;\n    const shopData = sessionStorage.getItem(\"surveyPayload\");\n    return ((_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.surveyPayload) || (shopData ? JSON.parse(shopData) : {});\n  });\n\n  // surveyData の変更を監視してログを出力\n  useEffect(() => {\n    console.log(\"==== SUEVRY RECEIVED ====\");\n    console.log(\"Raw sessionStorage:\", sessionStorage.getItem(\"surveyPayload\"));\n    console.log(\"Raw location.state:\", location.state);\n    console.log(\"Parsed surveyData:\", surveyData);\n    console.log(\"=========================\");\n  }, [surveyData]);\n  const [review, setReview] = useState(\"\");\n  const [rating, setRating] = useState(0);\n  const handleRating = newRating => setRating(newRating);\n  const handleSubmit = async event => {\n    event.preventDefault();\n    if (rating === 0) {\n      alert(\"評価を選択してください\");\n      return;\n    }\n    const formattedPayload = {\n      shop_id: surveyData.shop_id,\n      user_id: surveyData.user_id,\n      answer_time: surveyData.answer_time,\n      // JST タイムスタンプ\n      results: [{\n        // question_id: surveyData.results?.[0]?.question_id || \"00000000-0000-0000-0000-000000000001\",\n        star: rating.toString(),\n        comment: review.trim()\n      }]\n    };\n    console.log(\"!!!!!!formattedPayload:!!!!!\", formattedPayload);\n    try {\n      const response = await fetch(`http://0.0.0.0:5001/survey-results/comment/`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(formattedPayload)\n      });\n      if (!response.ok) throw new Error(\"レビュー送信に失敗しました\");\n      alert(\"ご回答ありがとうございました。\");\n      sessionStorage.removeItem(\"surveyPayload\"); // 送信後に削除\n      console.log(\"shopId\", shopId);\n      navigate(`/survey-app/survey-preview/${companyId}/${shopId}`);\n    } catch (err) {\n      console.error(\"送信エラー:\", err);\n      alert(\"送信エラーが発生しました。\");\n    }\n  };\n  const isSubmitDisabled = rating === 0; // Only disable if no rating is selected\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"review-container\",\n    children: [/*#__PURE__*/_jsxDEV(MenuBar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this), \" \", /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"\\u30EC\\u30D3\\u30E5\\u30FC\\u3092\\u5165\\u529B\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"\\u661F\\u3092\\u9078\\u629E\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\", /*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          color: 'red'\n        },\n        children: \"\\u5FC5\\u9808\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 20\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"star-rating\",\n      children: [1, 2, 3, 4, 5].map(star => /*#__PURE__*/_jsxDEV(FaStar, {\n        size: 30,\n        color: star <= rating ? \"#FFD700\" : \"#ccc\",\n        onClick: () => handleRating(star),\n        style: {\n          cursor: \"pointer\"\n        }\n      }, star, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"\\u3053\\u306E\\u5834\\u6240\\u3067\\u306E\\u4F53\\u9A13\\u3084\\u611F\\u60F3\\u3092\\u5171\\u6709\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\\u3002\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n        value: review,\n        onChange: e => setReview(e.target.value),\n        placeholder: \"\\u3053\\u3053\\u306B\\u30EC\\u30D3\\u30E5\\u30FC\\u3092\\u5165\\u529B...\",\n        className: \"review-textarea\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        disabled: isSubmitDisabled,\n        style: {\n          backgroundColor: isSubmitDisabled ? \"#ccc\" : \"#007bff\",\n          color: isSubmitDisabled ? \"#666\" : \"white\",\n          padding: \"10px 20px\",\n          fontSize: \"16px\",\n          border: \"none\",\n          cursor: isSubmitDisabled ? \"not-allowed\" : \"pointer\",\n          opacity: isSubmitDisabled ? 0.6 : 1,\n          transition: \"background-color 0.3s ease, opacity 0.3s ease\"\n        }\n        // 念のため、onClickでnavigateが重複しないように削除\n        ,\n        children: \"\\u9001\\u4FE1\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n};\n_s(SurevyCommentPage, \"wVhGVJCunGVi7OJT04G0X2bChME=\", false, function () {\n  return [useParams, useParams, useNavigate, useLocation];\n});\n_c = SurevyCommentPage;\nexport default SurevyCommentPage;\nvar _c;\n$RefreshReg$(_c, \"SurevyCommentPage\");","map":{"version":3,"names":["useState","useEffect","useParams","useNavigate","useLocation","FaStar","MenuBar","jsxDEV","_jsxDEV","SurevyCommentPage","_s","shopId","companyId","navigate","location","surveyData","setSurveyData","_location$state","shopData","sessionStorage","getItem","state","surveyPayload","JSON","parse","console","log","review","setReview","rating","setRating","handleRating","newRating","handleSubmit","event","preventDefault","alert","formattedPayload","shop_id","user_id","answer_time","results","star","toString","comment","trim","response","fetch","method","headers","body","stringify","ok","Error","removeItem","err","error","isSubmitDisabled","className","children","fileName","_jsxFileName","lineNumber","columnNumber","style","color","map","size","onClick","cursor","onSubmit","value","onChange","e","target","placeholder","type","disabled","backgroundColor","padding","fontSize","border","opacity","transition","_c","$RefreshReg$"],"sources":["/Users/user/Desktop/DEVELOPMENT/survey/frontend/src/pages/SurevyCommentPage.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { useParams, useNavigate, useLocation } from \"react-router-dom\";\nimport { FaStar } from \"react-icons/fa\";\nimport './SurevyCommentPage.css';\nimport MenuBar from \"./MenuBar\"; // Import the MenuBar component\n\nconst SurevyCommentPage = () => {\n  const { shopId } = useParams();\n  const { companyId } = useParams();\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  // `state` から取得 or `sessionStorage` から取得\n  const [surveyData, setSurveyData] = useState(() => {\n    const shopData = sessionStorage.getItem(\"surveyPayload\");\n    return location.state?.surveyPayload || (shopData ? JSON.parse(shopData) : {});\n  });\n\n  // surveyData の変更を監視してログを出力\n  useEffect(() => {\n    console.log(\"==== SUEVRY RECEIVED ====\");\n    console.log(\"Raw sessionStorage:\", sessionStorage.getItem(\"surveyPayload\"));\n    console.log(\"Raw location.state:\", location.state);\n    console.log(\"Parsed surveyData:\", surveyData);\n    console.log(\"=========================\");\n  }, [surveyData]);\n\n\n  const [review, setReview] = useState(\"\");\n  const [rating, setRating] = useState(0);\n\n  const handleRating = (newRating) => setRating(newRating);\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    if (rating === 0) {\n      alert(\"評価を選択してください\");\n      return;\n    }\n\n    const formattedPayload = {\n      shop_id: surveyData.shop_id,\n      user_id: surveyData.user_id,\n      answer_time: surveyData.answer_time, // JST タイムスタンプ\n      results: [\n        {\n          // question_id: surveyData.results?.[0]?.question_id || \"00000000-0000-0000-0000-000000000001\",\n          star: rating.toString(),\n          comment: review.trim(),\n        },\n      ],\n    };\n\n    console.log(\"!!!!!!formattedPayload:!!!!!\", formattedPayload);\n    try {\n      const response = await fetch(`http://0.0.0.0:5001/survey-results/comment/`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(formattedPayload),\n      });\n\n      if (!response.ok) throw new Error(\"レビュー送信に失敗しました\");\n\n      alert(\"ご回答ありがとうございました。\");\n      sessionStorage.removeItem(\"surveyPayload\"); // 送信後に削除\n      console.log(\"shopId\",shopId)\n      navigate(`/survey-app/survey-preview/${companyId}/${shopId}`);\n\n    } catch (err) {\n      console.error(\"送信エラー:\", err);\n      alert(\"送信エラーが発生しました。\");\n    }\n  };\n\n  const isSubmitDisabled = rating === 0; // Only disable if no rating is selected\n\n  return (\n    <div className=\"review-container\">\n      <MenuBar /> {/* Render the MenuBar component */}\n      <h1>レビューを入力</h1>\n      <p>星を選択してください<span style={{ color: 'red' }}>必須</span></p>\n      <div className=\"star-rating\">\n        {[1, 2, 3, 4, 5].map((star) => (\n          <FaStar\n            key={star}\n            size={30}\n            color={star <= rating ? \"#FFD700\" : \"#ccc\"}\n            onClick={() => handleRating(star)}\n            style={{ cursor: \"pointer\" }}\n          />\n        ))}\n      </div>\n\n      <p>この場所での体験や感想を共有してください。</p>\n      <form onSubmit={handleSubmit}>\n        <textarea\n          value={review}\n          onChange={(e) => setReview(e.target.value)}\n          placeholder=\"ここにレビューを入力...\"\n          className=\"review-textarea\"\n        />\n\n        <button\n          type=\"submit\"\n          disabled={isSubmitDisabled}\n          style={{\n            backgroundColor: isSubmitDisabled ? \"#ccc\" : \"#007bff\",\n            color: isSubmitDisabled ? \"#666\" : \"white\",\n            padding: \"10px 20px\",\n            fontSize: \"16px\",\n            border: \"none\",\n            cursor: isSubmitDisabled ? \"not-allowed\" : \"pointer\",\n            opacity: isSubmitDisabled ? 0.6 : 1,\n            transition: \"background-color 0.3s ease, opacity 0.3s ease\",\n          }}\n          // 念のため、onClickでnavigateが重複しないように削除\n        >\n          送信\n        </button>\n\n      </form>\n\n      {/* デバッグ用に画面にも表示\n      <div style={{ marginTop: \"20px\", padding: \"10px\", backgroundColor: \"#f4f4f4\", borderRadius: \"5px\" }}>\n        <h3>デバッグ情報:</h3>\n        <pre style={{ whiteSpace: \"pre-wrap\", wordBreak: \"break-word\" }}>\n          {JSON.stringify(surveyData, null, 2)}\n        </pre>\n      </div> */}\n\n    </div>\n  );\n};\n\nexport default SurevyCommentPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}